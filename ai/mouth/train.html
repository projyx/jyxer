<html>
    <head>
        <title>MouthTrain</title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0">
        <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.10.0/dist/tf.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/universal-sentence-encoder"></script>
        <script>
            window.onload = async function() {
                window.spark = {};
                window.spark.use = await use.load();
                window.spark.tokenizer = await use.loadTokenizer('/assets/json/vocab.json');
                window.spark.thought = 'Hello, how are you?';
                window.spark.soul = await tf.loadLayersModel('/soul/iris/index.json')

                // Encode real data.
                const trainData = ['Hello', 'How are you?', 'What is your purpose?', 'Can you generate text?', 'Tell me a joke'];
                const trainLabels = ['I am an AI language model.', "I'm doing well, thank you.", 'My purpose is to assist and provide information.', 'Yes, I can generate text based on a given prompt.', "Why don't scientists trust atoms? Because they make up everything!"];                
                
                var d = spark.tokenizer.encode('how are you');
                var l = spark.tokenizer.encode('i am fine');
                const inputSize = d.length;
                const outputSize = l.length;
                0 > 1 ? console.log(22, {
                    d,
                    l
                }) : null;

                //Use dummy data.
                var td = 0 > 1 ? d : [100, 784];
                var tl = 0 > 1 ? l : [100, 10];
                const data = tf.randomNormal(td);
                const labels = tf.randomUniform(tl);

                function onBatchEnd(batch, logs) {
                    console.log('Accuracy', logs.acc);
                }

                // Train for 5 epochs with batch size of 32.
                // Define the model architecture

                //Create Model
                window.spark.model = tf.sequential({
                    layers: [tf.layers.dense({
                        inputShape: [784],
                        units: 32,
                        activation: 'relu'
                    }), tf.layers.dense({
                        units: 10,
                        activation: 'softmax'
                    }), ]
                });

                // Compile the model
                spark.model.compile({
                    loss: 'categoricalCrossentropy',
                    optimizer: 'adam',
                    metrics: ['accuracy']
                });

                spark.model.fit(data, labels, {
                    epochs: 50,
                    batchSize: 32,
                    callbacks: {
                        onBatchEnd
                    }
                }).then(info=>{
                    console.log('Final accuracy', info.history.acc);
                }
                );
            }
        </script>
        <link href="index.css" rel="stylesheet">
    </head>
    <body></body>
</html>
